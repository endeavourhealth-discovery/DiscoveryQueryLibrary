use data_extracts;

drop procedure if exists executeEye;

DELIMITER //
CREATE PROCEDURE executeEye ()
BEGIN

  call populateCodeDateEye(1, 'DiabetesQof', 'dataset_eye', 0, 'C10.. ,C1010 ,C1011 ,C1030 ,C1031 ,C1080 ,C1081 ,C1082 ,C1083 ,C1085 ,C1086 ,C1087 ,C1088 ,C1089 ,C1090 ,C1091 ,C1092 ,C1093 ,C1094 ,C1095 ,C1096 ,C1097 ,C109J ,C109K ,C10C. ,C10D. ,C10E. ,C10E0 ,C10E1 ,C10E2 ,C10E3 ,C10E4 ,C10E5 ,C10E6 ,C10E7 ,C10E8 ,C10E9 ,C10EA ,C10EB ,C10EC ,C10ED ,C10EE ,C10EF ,C10EG ,C10EH ,C10EJ ,C10EK ,C10EL ,C10EM ,C10EN ,C10EP ,C10EQ ,C10ER ,C10F. ,C10F0 ,C10F1 ,C10F2 ,C10F3 ,C10F4 ,C10F5 ,C10F6 ,C10F7,C10F9, C10FA ,C10FB ,C10FC ,C10FD ,C10FE ,C10FF ,C10FG ,C10FH ,C10FJ ,C10FK ,C10FL ,C10FM ,C10FN ,C10FP ,C10FQ ,C10FR ,C10FS ,C10G. ,C10G0 ,C10H. ,C10H0 ,C10M. ,C10M0 ,C10N. ,C10N0 ,C10N1 ,X40J4 ,X40J5 ,X40J6 ,X40JA ,X40JB ,X40JC ,X40JG ,X40JI ,X40JJ ,X40JO ,X40JS ,X40JY ,X40JZ ,Xa4g7 ,XaELP ,XaELQ ,XaEnn ,XaEno ,XaEnp ,XaEnq ,XaF04 ,XaF05 ,XaFm8 ,XaFmA ,XaFmK ,XaFmL ,XaFmM ,XaFn7 ,XaFn8 ,XaFn9 ,XaFWG ,XaFWI ,XaIrf ,XaIzM ,XaIzN ,XaIzQ ,XaIzR ,XaJlL ,XaJlM ,XaJlQ ,XaJlR ,XaJQp ,XaJSr,XaJUI ,XaKyW ,XaKyX ,XaMzI ,XaOPt ,XaOPu ,XM1Xk ,XSETe ,XSETH ,XSETK ,XSETp,', 0, null);

  call populateCodeDateEye(1, 'BloodPressure', 'dataset_eye', 1,'246..,2461.,2462.,2463.,2464.,2465.,2466.,2467.,2469.,246A.,246a.,246B.,246b.,246C.,246c.,246D.,246d.,246E.,246e.,246F.,246f.,246G.,246g.,246J.,246l.,246m.,246N.,246o0,246o1,246P.,246Q.,246R.,246S.,246T.,246V.,246W.,246X.,246Y.,246Z.,33B5.,662B.,662C.,662L.,', 2, null);

  call populateCodeDateEye(1, 'HbA1c', 'dataset_eye', 1, '42W5., 42W4.,', 2, null);

  call populateCodeDateEye(1, 'Pregnancy', 'dataset_eye', 0, '1521.,621..,6211.,6212.,6213.,6214.,6215.,6216.,6217.,6218.,621A.,621B.,621Z.,L21..,L210.,L2100,L2102,L210z,L211.,L2110,L2112,L211z,L212.,L2120,L2122,L212z,L21y.,L21y0,L21y2,L21yz,L21z.,L21z0,L21z2,L2940,L2942,L294z,L295.,L2950,L2952,L295z,X40Ac,X40Ad,X40Af,X40Ag,X40Ah,X40Ai,X40Ak,X40Al,X40Am,X40An,X40Ao,X40Ap,X40Aq,X40Ar,X40At,X40Av,X40Ax,X40Ay,X40Az,X40B0,X40B1,X76Qo,X76Qt,X78yp,Xa048,Xa4SU,Xa85U,XaEgS,XE0oR,XE0pC,ZV619,', 0, null);

  call populateCodeDateEye(1, 'GP2DRSDiabetes', 'dataset_eye', 0, 'C10.. ,C100. ,C1000 ,C1001 ,C100z ,C101. ,C1010 ,C1011 ,C101y ,C101z ,C102. ,C1020 ,C1021 ,C102z ,C103. ,C1030 ,C1031 ,C103y ,C103z ,C104. ,C1040 ,C1041 ,C104y ,C104z ,C105. ,C1050 ,C1051 ,C105y ,C105z ,C106. ,C1060 ,C1061 ,66AJ1 ,C106y ,C106z ,C107. ,C1070 ,C1071 ,C1072 ,C1073 ,C1074 ,C107y ,C107z ,C108. ,C1080 ,C1081 ,C1082 ,C1083 ,C1084 ,C1085 ,C1086 ,C1087 ,C1088 ,C1089 ,C108A ,C108B ,C108C ,C108D ,C108E ,C108F ,C108G ,C108H,C108J ,C108y ,C108z ,C109. ,C1090 ,C1091 ,C1092 ,C1093 ,C1094 ,C1095 ,C1096 ,C1097 ,C1099 ,C109A ,C109B ,C109C ,C109D ,C109E ,C109F ,C109G ,C109H ,C109J ,C109K ,C10A. ,C10A0 ,C10A1 ,C10A2 ,C10A3 ,C10A4 ,C10A5 ,C10A6 ,C10A7 ,C10AW ,C10AX ,C10B. ,C10B0 ,C10C. ,C10D. ,C10E. ,C10E0 ,C10E1 ,C10E2 ,C10E3 ,C10E4 ,C10E5 ,C10E6 ,C10E7 ,C10E8 ,C10E9 ,C10EA ,C10EB ,C10EC ,C10ED ,C10EE ,C10EF ,C10EG ,C10EH ,C10EJ ,C10EK ,C10EL ,C10EM ,C10EN ,C10EP ,C10EQ ,C10ER ,C10F. ,C10F0 ,C10F1 ,C10F2 ,C10F3,C10F4 ,C10F5 ,C10F6 ,C10F7 ,C10F9 ,C10FA ,C10FB ,C10FC ,C10FD ,C10FE ,C10FF ,C10FG ,C10FH ,C10FJ ,C10FK ,C10FL ,C10FM ,C10FN ,C10FP ,C10FQ ,C10FR ,C10FS ,C10G. ,C10G0 ,C10H. ,C10H0 ,C10J. ,C10J0 ,C10M. ,C10M0 ,C10N. ,C10N0 ,C10N1 ,C10P. ,C10P0 ,C10P1 ,C10y. ,C10y0 ,C10y1 ,C10yy ,C10yz ,C10z. ,C10z0 ,C10z1 ,C10zy ,C10zz ,C11y0 ,Cyu2. ,Cyu20 ,Cyu21 ,Cyu22 ,Cyu23 ,L1805 ,L1806 ,L1807 ,L180X ,Lyu29 ,PKyP. ,X008t ,X40J4 ,X40J5 ,X40J6 ,X40J7 ,X40J8 ,X40J9 ,X40JA ,X40Ja ,X40JB ,X40Jb ,X40JC,X40JG ,X40JI ,X40JJ ,X40JK ,X40JN ,X40JO ,X40JR ,X40JS ,X40JV ,X40JW ,X40JX ,X40JY ,X40JZ ,Xa3ee ,Xa4g7 ,Xaagd ,Xaage ,Xaagf ,XaCJ2 ,XaELP ,XaELQ ,XaEnn ,XaEno ,XaEnp ,XaEnq ,XaF04 ,XaF05 ,XaFm8 ,XaFmA ,XaFmK ,XaFmL ,XaFmM ,XaFn7 ,XaFn8 ,XaFn9 ,XaFWG ,XaFWI ,XaIrf ,XaIzM ,XaIzN ,XaIzQ ,XaIzR ,XaJlL ,XaJlM ,XaJlN ,XaJlQ ,XaJlR ,XaJQp ,XaJSr ,XaJUH ,XaJUI ,XaKyW ,XaKyX ,XaMzI ,XaOPt ,XaOPu ,XE10E ,XE10F ,XE10G ,XE10H ,XE10I ,XE128 ,XE12A ,XE12C ,XE12G ,XE12K ,XE12M ,XM1Qx ,XM1Xk ,XSETe,XSETH ,XSETK ,XSETp,',0, null);

  call populateCodeDateEye(1, 'ConsentScreeningProvided', 'dataset_eye', 0,'9NdA., XaNQW,', 0, null);

  call populateCodeDateEye(1, 'ConsentScreeningImplied', 'dataset_eye', 0,'9NdB., XaNQX,', 0, null);

  call populateCodeDateEye(1, 'ConsentScreeningWithheld', 'dataset_eye', 0,'9NdC., XaNQY,', 0, null);

  update dataset_eye d set d.NhsNumber = d.pseudo_id;


END//
DELIMITER ;
